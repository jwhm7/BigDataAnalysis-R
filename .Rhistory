ucla <- read.csv('http://stats.idre.ucla.edu/stat/data/binary.csv')
head(ucla)
control <- trainControl(method='cv', number= 5)
control <- trainControl(method='cv', number= 5)
library(caret)
library(rpart)
library(randomForest)
library(e1071)
library(class)
library(survival)
head(colon)
colon = na.omit(colon)
colon= colon[c(TRUE, FALSE), ]
colon$status <- factor(colon$status)
set.seed(2021)
data <- colon[sample(nrow(colon)),]
control_5 <- trainControl(method= 'cv', number= 5)
rf_5 <- train(status~., data = colon, method= 'rf',
metric= 'Accuracy', trControl= control_5)
# 혼동행렬
confusionMatrix(rf_5)
# 정확도
confusionMatrix(rf_5)$table[2,2]/(confusionMatrix(rf_5)$table[2,1] +
confusionMatrix(rf_5)$table[2,2])
set.seed(2021)
data <- colon[sample(nrow(colon)),]
control_10 <- trainControl(method= 'cv', number= 10)
rf_10 <- train(status~., data = colon, method= 'rf',
metric= 'Accuracy', trControl= control_10)
# 혼동행렬
confusionMatrix(rf_10)
# 정확도
confusionMatrix(rf_10)$table[2,2]/(confusionMatrix(rf_10)$table[2,1] +
confusionMatrix(rf_10)$table[2,2])
set.seed(2021)
data <- colon[sample(nrow(colon)),]
control_15 <- trainControl(method= 'cv', number= 15)
rf_15 <- train(status~., data = colon, method= 'rf',
metric= 'Accuracy', trControl= control_15)
# 혼동행렬
confusionMatrix(rf_15)
# 정확도
confusionMatrix(rf_15)$table[2,2]/(confusionMatrix(rf_15)$table[2,1] +
confusionMatrix(rf_15)$table[2,2])
set.seed(2021)
data <- colon[sample(nrow(colon)),]
control_20 <- trainControl(method= 'cv', number= 20)
rf_20 <- train(status~., data = colon, method= 'rf',
metric= 'Accuracy', trControl= control_20)
# 혼동행렬
confusionMatrix(rf_20)
# 정확도
confusionMatrix(rf_20)$table[2,2]/(confusionMatrix(rf_20)$table[2,1] +
confusionMatrix(rf_20)$table[2,2])
ucla <- read.csv('http://stats.idre.ucla.edu/stat/data/binary.csv')
head(ucla)
set.seed(2021)
data <- ucla[sample(nrow(ucla)),]
ucla$admit <- factor(ucla$admit)
control <- trainControl(method='cv', number= 5)
L <- train(admit~., data= ucla, method= 'svmLinear', metric= 'Accuracy',
trControl= control)
LM <- train(admit~., data= ucla, method= 'svmLinearWeights', metric= 'Accuracy',
trControl= control)
P <- train(admit~., data= ucla, method= 'svmPoly', metric= 'Accuracy',
trControl= control)
R <- train(admit~., data= ucla, method= 'svmRadial', metric= 'Accuracy',
trControl= control)
RW <- train(admit~., data= ucla, method= 'svmRadialWeights', metric= 'Accuracy',
trControl= control)
f100 <- train(admit~., data= ucla, method= 'rf', ntree= 100, metric= 'Accuracy',
trControl= control)
f300 <- train(admit~., data= ucla, method= 'rf', ntree= 300, metric= 'Accuracy',
trControl= control)
f500 <- train(admit~., data= ucla, method= 'rf', ntree= 500, metric= 'Accuracy',
trControl= control)
r <- train(admit~., data= ucla, method= 'rpart', metric= 'Accuracy',
trControl= control)
k <- train(admit~., data= ucla, method= 'knn', metric= 'Accuracy',
trControl= control)
g <- train(admit~., data= ucla, method= 'glm', metric= 'Accuracy',
trControl= control)
resamp <- resamples(list(선형= L, 선형가중치= LM, 다항식= P, RBF= R, 가중치= RW,
rf100= f100, rf300= f300, rf500= f500, tree= r, KNN= k, glm= g))
resamp <- resamples(list(선형= L, 선형가중치= LM, 다항식= P, RBF= R, 가중치= RW,
rf100= f100, rf300= f300, rf500= f500, tree= r, KNN= k, glm= g))
summary(resamp)
sort(resamp, decreasin= TRUE)
dotplot(resamp)
voice <- read.csv('data/voice.csv')
setwd("~/R")
voice <- read.csv('data/voice.csv')
str(voice)
set.seed(2021)
data <- voice[sample(nrow(voice)),]
voice$label <- factor(voice$label)
control <- trainControl(method='cv', number= 10)
L <- train(label~., data= voice, method= 'svmLinear', metric= 'Accuracy',
trControl= control)
LM <- train(label~., data= voice, method= 'svmLinearWeights', metric= 'Accuracy',
trControl= control)
P <- train(label~., data= voice, method= 'svmPoly', metric= 'Accuracy',
trControl= control)
R <- train(label~., data= voice, method= 'svmRadial', metric= 'Accuracy',
trControl= control)
RW <- train(label~., data= voice, method= 'svmRadialWeights', metric= 'Accuracy',
trControl= control)
f100 <- train(label~., data= voice, method= 'rf', ntree= 100, metric= 'Accuracy',
trControl= control)
f300 <- train(label~., data= voice, method= 'rf', ntree= 300, metric= 'Accuracy',
trControl= control)
